cmake_minimum_required(VERSION 3.13.1)
include($ENV{ZEPHYR_BASE}/cmake/app/boilerplate.cmake NO_POLICY_SCOPE)
project(tf_lite_magic_wand)

# -fno-threadsafe-statics -- disables the mutex around initialization of local static variables
set(CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -std=c++11 -fno-rtti -fno-exceptions -fno-threadsafe-statics -fno-unwind-tables -ffunction-sections -fdata-sections -fmessage-length=0 -DTF_LITE_STATIC_MEMORY -DTF_LITE_DISABLE_X86_NEON -O3 -Wsign-compare -Wdouble-promotion -Wshadow -Wunused-variable -Wmissing-field-initializers -Wunused-function -Wswitch -Wvla -Wall -Wextra -Wstrict-aliasing -Wno-unused-parameter -DZEPHYR_VEXRISCV -fno-threadsafe-statics -Wno-sign-compare -Wno-narrowing")
set(CMAKE_C_FLAGS  "${CMAKE_C_FLAGS} -std=c11 -fno-unwind-tables -ffunction-sections -fdata-sections -fmessage-length=0 -DTF_LITE_STATIC_MEMORY -DTF_LITE_DISABLE_X86_NEON -O3 -DZEPHYR_VEXRISCV")
set(CMAKE_EXE_LINKER_FLAGS "-Wl,--fatal-warnings -Wl,--gc-sections -lm")

target_sources(app PRIVATE
		tensorflow/lite/micro/simple_memory_allocator.cc tensorflow/lite/micro/micro_error_reporter.cc tensorflow/lite/micro/memory_helpers.cc tensorflow/lite/micro/test_helpers.cc tensorflow/lite/micro/micro_time.cc tensorflow/lite/micro/recording_simple_memory_allocator.cc tensorflow/lite/micro/micro_string.cc tensorflow/lite/micro/micro_profiler.cc tensorflow/lite/micro/micro_utils.cc tensorflow/lite/micro/debug_log.cc tensorflow/lite/micro/all_ops_resolver.cc tensorflow/lite/micro/micro_interpreter.cc tensorflow/lite/micro/micro_allocator.cc tensorflow/lite/micro/recording_micro_allocator.cc tensorflow/lite/micro/system_setup.cc tensorflow/lite/micro/memory_planner/linear_memory_planner.cc tensorflow/lite/micro/memory_planner/greedy_memory_planner.cc tensorflow/lite/c/common.c tensorflow/lite/core/api/error_reporter.cc tensorflow/lite/core/api/flatbuffer_conversions.cc tensorflow/lite/core/api/op_resolver.cc tensorflow/lite/core/api/tensor_utils.cc tensorflow/lite/kernels/internal/quantization_util.cc tensorflow/lite/kernels/kernel_util.cc tensorflow/lite/schema/schema_utils.cc tensorflow/lite/micro/kernels/activations.cc tensorflow/lite/micro/kernels/add.cc tensorflow/lite/micro/kernels/add_n.cc tensorflow/lite/micro/kernels/arg_min_max.cc tensorflow/lite/micro/kernels/batch_to_space_nd.cc tensorflow/lite/micro/kernels/cast.cc tensorflow/lite/micro/kernels/ceil.cc tensorflow/lite/micro/kernels/circular_buffer.cc tensorflow/lite/micro/kernels/comparisons.cc tensorflow/lite/micro/kernels/concatenation.cc tensorflow/lite/micro/kernels/conv.cc tensorflow/lite/micro/kernels/conv_common.cc tensorflow/lite/micro/kernels/cumsum.cc tensorflow/lite/micro/kernels/depth_to_space.cc tensorflow/lite/micro/kernels/depthwise_conv.cc tensorflow/lite/micro/kernels/depthwise_conv_common.cc tensorflow/lite/micro/kernels/dequantize.cc tensorflow/lite/micro/kernels/detection_postprocess.cc tensorflow/lite/micro/kernels/elementwise.cc tensorflow/lite/micro/kernels/elu.cc tensorflow/lite/micro/kernels/ethosu.cc tensorflow/lite/micro/kernels/exp.cc tensorflow/lite/micro/kernels/expand_dims.cc tensorflow/lite/micro/kernels/fill.cc tensorflow/lite/micro/kernels/floor.cc tensorflow/lite/micro/kernels/floor_div.cc tensorflow/lite/micro/kernels/floor_mod.cc tensorflow/lite/micro/kernels/fully_connected.cc tensorflow/lite/micro/kernels/fully_connected_common.cc tensorflow/lite/micro/kernels/hard_swish.cc tensorflow/lite/micro/kernels/kernel_runner.cc tensorflow/lite/micro/kernels/kernel_util.cc tensorflow/lite/micro/kernels/l2norm.cc tensorflow/lite/micro/kernels/l2_pool_2d.cc tensorflow/lite/micro/kernels/leaky_relu.cc tensorflow/lite/micro/kernels/logical.cc tensorflow/lite/micro/kernels/logistic.cc tensorflow/lite/micro/kernels/log_softmax.cc tensorflow/lite/micro/kernels/maximum_minimum.cc tensorflow/lite/micro/kernels/mul.cc tensorflow/lite/micro/kernels/neg.cc tensorflow/lite/micro/kernels/pack.cc tensorflow/lite/micro/kernels/pad.cc tensorflow/lite/micro/kernels/pooling.cc tensorflow/lite/micro/kernels/prelu.cc tensorflow/lite/micro/kernels/quantize.cc tensorflow/lite/micro/kernels/quantize_common.cc tensorflow/lite/micro/kernels/reduce.cc tensorflow/lite/micro/kernels/reshape.cc tensorflow/lite/micro/kernels/resize_nearest_neighbor.cc tensorflow/lite/micro/kernels/round.cc tensorflow/lite/micro/kernels/shape.cc tensorflow/lite/micro/kernels/softmax.cc tensorflow/lite/micro/kernels/softmax_common.cc tensorflow/lite/micro/kernels/space_to_batch_nd.cc tensorflow/lite/micro/kernels/split.cc tensorflow/lite/micro/kernels/split_v.cc tensorflow/lite/micro/kernels/squeeze.cc tensorflow/lite/micro/kernels/strided_slice.cc tensorflow/lite/micro/kernels/sub.cc tensorflow/lite/micro/kernels/svdf.cc tensorflow/lite/micro/kernels/svdf_common.cc tensorflow/lite/micro/kernels/tanh.cc tensorflow/lite/micro/kernels/transpose_conv.cc tensorflow/lite/micro/kernels/unpack.cc tensorflow/lite/micro/kernels/zeros_like.cc  tensorflow/lite/micro/examples/hello_world/zephyr_riscv/src/assert.cc tensorflow/lite/micro/examples/hello_world/main.cc tensorflow/lite/micro/examples/hello_world/main_functions.cc tensorflow/lite/micro/examples/hello_world/constants.cc tensorflow/lite/micro/examples/hello_world/output_handler.cc tensorflow/lite/micro/examples/hello_world/model.cc prj.conf tensorflow/lite/micro/system_setup.h tensorflow/lite/micro/simple_memory_allocator.h tensorflow/lite/micro/micro_utils.h tensorflow/lite/micro/micro_op_resolver.h tensorflow/lite/micro/micro_profiler.h tensorflow/lite/micro/memory_helpers.h tensorflow/lite/micro/test_helpers.h tensorflow/lite/micro/micro_time.h tensorflow/lite/micro/recording_micro_interpreter.h tensorflow/lite/micro/recording_micro_allocator.h tensorflow/lite/micro/micro_error_reporter.h tensorflow/lite/micro/micro_mutable_op_resolver.h tensorflow/lite/micro/debug_log.h tensorflow/lite/micro/recording_simple_memory_allocator.h tensorflow/lite/micro/micro_string.h tensorflow/lite/micro/all_ops_resolver.h tensorflow/lite/micro/compatibility.h tensorflow/lite/micro/micro_interpreter.h tensorflow/lite/micro/micro_allocator.h tensorflow/lite/micro/benchmarks/keyword_scrambled_model_data.h tensorflow/lite/micro/kernels/conv.h tensorflow/lite/micro/kernels/micro_utils.h tensorflow/lite/micro/kernels/conv_test.h tensorflow/lite/micro/kernels/kernel_util.h tensorflow/lite/micro/kernels/quantize.h tensorflow/lite/micro/kernels/ethosu.h tensorflow/lite/micro/kernels/svdf.h tensorflow/lite/micro/kernels/depthwise_conv.h tensorflow/lite/micro/kernels/activation_utils.h tensorflow/lite/micro/kernels/softmax.h tensorflow/lite/micro/kernels/circular_buffer_flexbuffers_generated_data.h tensorflow/lite/micro/kernels/kernel_runner.h tensorflow/lite/micro/kernels/detection_postprocess_flexbuffers_generated_data.h tensorflow/lite/micro/kernels/fully_connected.h tensorflow/lite/micro/kernels/micro_ops.h tensorflow/lite/micro/memory_planner/linear_memory_planner.h tensorflow/lite/micro/memory_planner/memory_planner.h tensorflow/lite/micro/memory_planner/greedy_memory_planner.h tensorflow/lite/c/builtin_op_data.h tensorflow/lite/c/c_api_types.h tensorflow/lite/c/common.h tensorflow/lite/core/api/error_reporter.h tensorflow/lite/core/api/flatbuffer_conversions.h tensorflow/lite/core/api/op_resolver.h tensorflow/lite/core/api/tensor_utils.h tensorflow/lite/kernels/internal/common.h tensorflow/lite/kernels/internal/compatibility.h tensorflow/lite/kernels/internal/optimized/neon_check.h tensorflow/lite/kernels/internal/quantization_util.h tensorflow/lite/kernels/internal/reference/add.h tensorflow/lite/kernels/internal/reference/add_n.h tensorflow/lite/kernels/internal/reference/arg_min_max.h tensorflow/lite/kernels/internal/reference/batch_to_space_nd.h tensorflow/lite/kernels/internal/reference/binary_function.h tensorflow/lite/kernels/internal/reference/ceil.h tensorflow/lite/kernels/internal/reference/comparisons.h tensorflow/lite/kernels/internal/reference/concatenation.h tensorflow/lite/kernels/internal/reference/conv.h tensorflow/lite/kernels/internal/reference/cumsum.h tensorflow/lite/kernels/internal/reference/depth_to_space.h tensorflow/lite/kernels/internal/reference/depthwiseconv_float.h tensorflow/lite/kernels/internal/reference/depthwiseconv_uint8.h tensorflow/lite/kernels/internal/reference/dequantize.h tensorflow/lite/kernels/internal/reference/elu.h tensorflow/lite/kernels/internal/reference/exp.h tensorflow/lite/kernels/internal/reference/fill.h tensorflow/lite/kernels/internal/reference/floor.h tensorflow/lite/kernels/internal/reference/floor_div.h tensorflow/lite/kernels/internal/reference/floor_mod.h tensorflow/lite/kernels/internal/reference/fully_connected.h tensorflow/lite/kernels/internal/reference/hard_swish.h tensorflow/lite/kernels/internal/reference/integer_ops/add.h tensorflow/lite/kernels/internal/reference/integer_ops/conv.h tensorflow/lite/kernels/internal/reference/integer_ops/depthwise_conv.h tensorflow/lite/kernels/internal/reference/integer_ops/fully_connected.h tensorflow/lite/kernels/internal/reference/integer_ops/logistic.h tensorflow/lite/kernels/internal/reference/integer_ops/l2normalization.h tensorflow/lite/kernels/internal/reference/integer_ops/mean.h tensorflow/lite/kernels/internal/reference/integer_ops/mul.h tensorflow/lite/kernels/internal/reference/integer_ops/pooling.h tensorflow/lite/kernels/internal/reference/integer_ops/tanh.h tensorflow/lite/kernels/internal/reference/integer_ops/transpose_conv.h tensorflow/lite/kernels/internal/reference/l2normalization.h tensorflow/lite/kernels/internal/reference/leaky_relu.h tensorflow/lite/kernels/internal/reference/log_softmax.h tensorflow/lite/kernels/internal/reference/maximum_minimum.h tensorflow/lite/kernels/internal/reference/mul.h tensorflow/lite/kernels/internal/reference/neg.h tensorflow/lite/kernels/internal/reference/pad.h tensorflow/lite/kernels/internal/reference/pooling.h tensorflow/lite/kernels/internal/reference/prelu.h tensorflow/lite/kernels/internal/reference/process_broadcast_shapes.h tensorflow/lite/kernels/internal/reference/quantize.h tensorflow/lite/kernels/internal/reference/reduce.h tensorflow/lite/kernels/internal/reference/requantize.h tensorflow/lite/kernels/internal/reference/resize_nearest_neighbor.h tensorflow/lite/kernels/internal/reference/round.h tensorflow/lite/kernels/internal/reference/softmax.h tensorflow/lite/kernels/internal/reference/space_to_batch_nd.h tensorflow/lite/kernels/internal/reference/sub.h tensorflow/lite/kernels/internal/reference/logistic.h tensorflow/lite/kernels/internal/reference/strided_slice.h tensorflow/lite/kernels/internal/reference/tanh.h tensorflow/lite/kernels/internal/reference/transpose_conv.h tensorflow/lite/kernels/internal/cppmath.h tensorflow/lite/kernels/internal/max.h tensorflow/lite/kernels/internal/min.h tensorflow/lite/kernels/internal/portable_tensor.h tensorflow/lite/kernels/internal/strided_slice_logic.h tensorflow/lite/kernels/internal/tensor_ctypes.h tensorflow/lite/kernels/internal/types.h tensorflow/lite/kernels/kernel_util.h tensorflow/lite/kernels/op_macros.h tensorflow/lite/kernels/padding.h tensorflow/lite/portable_type_to_tflitetype.h tensorflow/lite/schema/schema_generated.h tensorflow/lite/schema/schema_utils.h  third_party/gemmlowp/fixedpoint/fixedpoint.h third_party/gemmlowp/fixedpoint/fixedpoint_neon.h third_party/gemmlowp/fixedpoint/fixedpoint_sse.h third_party/gemmlowp/internal/detect_platform.h third_party/gemmlowp/LICENSE third_party/flatbuffers/include/flatbuffers/base.h third_party/flatbuffers/include/flatbuffers/stl_emulation.h third_party/flatbuffers/include/flatbuffers/flatbuffers.h third_party/flatbuffers/include/flatbuffers/flexbuffers.h third_party/flatbuffers/include/flatbuffers/util.h third_party/flatbuffers/LICENSE.txt third_party/ruy/ruy/profiler/instrumentation.h third_party/kissfft/COPYING third_party/kissfft/kiss_fft.h third_party/kissfft/_kiss_fft_guts.h third_party/kissfft/tools/kiss_fftr.h tensorflow/lite/micro/examples/hello_world/model.h tensorflow/lite/micro/examples/hello_world/output_handler.h tensorflow/lite/micro/examples/hello_world/constants.h tensorflow/lite/micro/examples/hello_world/main_functions.h
		)

target_include_directories(app PRIVATE
		third_party/gemmlowp third_party/kissfft third_party/flatbuffers/include third_party/ruy %{INCLUDE_DIRS}%
                )
